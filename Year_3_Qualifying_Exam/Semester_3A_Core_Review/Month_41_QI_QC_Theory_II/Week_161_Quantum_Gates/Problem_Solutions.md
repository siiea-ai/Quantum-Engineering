# Week 161: Quantum Gates - Complete Problem Solutions

---

## Section A: Single-Qubit Gates Solutions

### Solution 1: Pauli Matrix Algebra

**Part a) $XYZ = iI$**

$$XY = \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}\begin{pmatrix} 0 & -i \\ i & 0 \end{pmatrix} = \begin{pmatrix} i & 0 \\ 0 & -i \end{pmatrix} = iZ$$

$$XYZ = (iZ)Z = iZ^2 = iI \quad \checkmark$$

**Part b) $\{X, Y\} = XY + YX = 0$**

$$YX = \begin{pmatrix} 0 & -i \\ i & 0 \end{pmatrix}\begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix} = \begin{pmatrix} -i & 0 \\ 0 & i \end{pmatrix} = -iZ$$

$$\{X, Y\} = iZ + (-iZ) = 0 \quad \checkmark$$

**Part c) $[X, Y] = XY - YX = 2iZ$**

$$[X, Y] = iZ - (-iZ) = 2iZ \quad \checkmark$$

**Basis Decomposition:**

For any $M = \begin{pmatrix} m_{11} & m_{12} \\ m_{21} & m_{22} \end{pmatrix}$:

$$a = \frac{m_{11} + m_{22}}{2}, \quad d = \frac{m_{11} - m_{22}}{2}$$
$$b = \frac{m_{12} + m_{21}}{2}, \quad c = \frac{i(m_{12} - m_{21})}{2}$$

Verify: $aI + bX + cY + dZ = M$ $\checkmark$

---

### Solution 2: Bloch Sphere Rotations

**Part a) Hadamard as rotation**

The Hadamard gate is:
$$H = \frac{1}{\sqrt{2}}(X + Z)$$

For rotation about $\hat{n} = (n_x, 0, n_z) = (1/\sqrt{2}, 0, 1/\sqrt{2})$:

$$R_{\hat{n}}(\pi) = \cos(\pi/2)I - i\sin(\pi/2)(n_x X + n_z Z) = -i\frac{1}{\sqrt{2}}(X + Z) = -iH$$

Up to global phase, $H = R_{\hat{n}}(\pi)$ with $\hat{n} = (\hat{x} + \hat{z})/\sqrt{2}$ $\checkmark$

**Part b) Finding axis and angle for G**

$$G = \frac{1}{2}\begin{pmatrix} 1+i & 1-i \\ 1-i & 1+i \end{pmatrix}$$

Eigenvalues: $\det(G - \lambda I) = 0$
$$(1+i)/2 - \lambda)^2 - ((1-i)/2)^2 = 0$$
$$\lambda = e^{i\pi/4}, e^{-i\pi/4}$$

So $\theta/2 = \pi/4$, thus $\theta = \pi/2$.

Axis: From $G = e^{-i(\pi/4)(\hat{n}\cdot\vec{\sigma})}$, we find $\hat{n} = (1, 0, 1)/\sqrt{2}$ (same as Hadamard direction).

Answer: Rotation by $\pi/2$ about axis $(1, 0, 1)/\sqrt{2}$.

**Part c) $R_x(\pi/2)R_z(\pi/2)R_x(-\pi/2)$**

Using the identity $R_x(\alpha)R_z(\beta)R_x(-\alpha) = R_{\hat{n}(\alpha)}(\beta)$ where $\hat{n}(\alpha)$ is $\hat{z}$ rotated about $\hat{x}$ by $\alpha$:

For $\alpha = \pi/2$: $\hat{z}$ rotated about $\hat{x}$ by $\pi/2$ gives $-\hat{y}$.

Therefore: $R_x(\pi/2)R_z(\pi/2)R_x(-\pi/2) = R_{-y}(\pi/2) = R_y(-\pi/2)$ $\checkmark$

---

### Solution 3: ZYZ Decomposition

**General Formula:** $U = e^{i\alpha}R_z(\beta)R_y(\gamma)R_z(\delta)$

**Part a) Hadamard gate**

$$H = \frac{1}{\sqrt{2}}\begin{pmatrix} 1 & 1 \\ 1 & -1 \end{pmatrix}$$

Comparing with $R_z(\beta)R_y(\gamma)R_z(\delta)$:

The $(0,0)$ element: $e^{-i(\beta+\delta)/2}\cos(\gamma/2) = 1/\sqrt{2}$
The $(0,1)$ element: $-e^{-i(\beta-\delta)/2}\sin(\gamma/2) = 1/\sqrt{2}$

Solution: $\gamma = \pi/2$, $\beta = \pi$, $\delta = 0$, $\alpha = \pi/2$

$$\boxed{H = e^{i\pi/2}R_z(\pi)R_y(\pi/2)R_z(0) = iR_z(\pi)R_y(\pi/2)}$$

**Part b) T gate**

$$T = \begin{pmatrix} 1 & 0 \\ 0 & e^{i\pi/4} \end{pmatrix}$$

$T$ is already diagonal, so $\gamma = 0$:

$$\boxed{T = e^{i\pi/8}R_z(\pi/4)}$$

**Part c) $U = \frac{1}{\sqrt{2}}\begin{pmatrix} 1 & i \\ i & 1 \end{pmatrix}$**

This is $R_x(\pi/2) = e^{-i\pi X/4}$.

$$\boxed{U = R_z(-\pi/2)R_y(\pi/2)R_z(\pi/2)}$$

---

### Solution 4: Gate Composition

**Part a) $R_x(\theta)$ in terms of $H$ and $R_z$**

Using $HZH = X$:
$$R_x(\theta) = e^{-i\theta X/2} = He^{-i\theta Z/2}H = HR_z(\theta)H$$

$$\boxed{R_x(\theta) = HR_z(\theta)H}$$

**Part b) $HTH = R_x(\pi/4)$ up to global phase**

$$HTH = H\begin{pmatrix} 1 & 0 \\ 0 & e^{i\pi/4} \end{pmatrix}H = HR_z(\pi/4)e^{i\pi/8}H = e^{i\pi/8}HR_z(\pi/4)H = e^{i\pi/8}R_x(\pi/4)$$

$$\boxed{HTH = e^{i\pi/8}R_x(\pi/4)}$$

**Part c) $U$ such that $UXU^\dagger = Y$**

We need to rotate $X$ to $Y$ on the Bloch sphere, which is a $\pi/2$ rotation about $Z$:

$$\boxed{U = S = R_z(\pi/2)e^{i\pi/4}}$$

Verify: $SXS^\dagger = \begin{pmatrix} 1 & 0 \\ 0 & i \end{pmatrix}\begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}\begin{pmatrix} 1 & 0 \\ 0 & -i \end{pmatrix} = \begin{pmatrix} 0 & -i \\ i & 0 \end{pmatrix} = Y$ $\checkmark$

---

### Solution 5: Eigenstructure

**Part a) Hadamard gate $H$**

Eigenvalue equation: $\det(H - \lambda I) = 0$
$$\frac{1}{2}((1-\lambda\sqrt{2})(-1-\lambda\sqrt{2}) - 1) = 0$$
$$\lambda = \pm 1$$

Eigenvectors:
- $\lambda = 1$: $|+\rangle_{H} = \cos(\pi/8)|0\rangle + \sin(\pi/8)|1\rangle$
- $\lambda = -1$: $|-\rangle_{H} = \sin(\pi/8)|0\rangle - \cos(\pi/8)|1\rangle$

**Part b) $Y$ gate**

Eigenvalues: $\lambda = \pm 1$
Eigenvectors: $|y_+\rangle = \frac{1}{\sqrt{2}}(|0\rangle + i|1\rangle)$, $|y_-\rangle = \frac{1}{\sqrt{2}}(|0\rangle - i|1\rangle)$

**Part c) $S$ gate**

Eigenvalues: $\lambda = 1, i$
Eigenvectors: $|0\rangle$ (eigenvalue 1), $|1\rangle$ (eigenvalue $i$)

---

### Solution 8: Clifford Group

**Part a) Single-qubit Clifford generated by $\{H, S\}$**

The single-qubit Clifford group consists of gates that map Pauli operators to Pauli operators under conjugation.

Starting from $I$:
- $H$: maps $Z \leftrightarrow X$, fixes $Y$ (up to sign)
- $S$: maps $X \to Y$, fixes $Z$
- $SH$: maps $X \to Z \to X$, complex permutation
- Continuing generates 24 distinct elements (up to phase)

**Part b) 24 elements**

The Clifford group acts on the Pauli operators $\{X, Y, Z\}$. The action must:
1. Permute $\{X, Y, Z\}$ (6 possibilities)
2. Assign signs (8 possibilities per element, but constrained)

The constraint $XYZ = iI$ (up to sign) reduces to 24 elements, isomorphic to the octahedral group.

**Part c) $T$ is not Clifford**

$$TXT^\dagger = \begin{pmatrix} 1 & 0 \\ 0 & e^{i\pi/4} \end{pmatrix}\begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}\begin{pmatrix} 1 & 0 \\ 0 & e^{-i\pi/4} \end{pmatrix} = \begin{pmatrix} 0 & e^{-i\pi/4} \\ e^{i\pi/4} & 0 \end{pmatrix}$$

This is $\frac{1}{\sqrt{2}}(X - Y) \neq$ any Pauli (up to phase). $\checkmark$

---

## Section B: Two-Qubit Gates Solutions

### Solution 11: CNOT Properties

**Part a) $\text{CNOT}^2 = I$**

$$\text{CNOT}^2 = \begin{pmatrix} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 0 & 1 \\ 0 & 0 & 1 & 0 \end{pmatrix}^2 = \begin{pmatrix} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1 \end{pmatrix} = I \quad \checkmark$$

**Part b) Creating Bell state**

$$|+\rangle|0\rangle = \frac{1}{\sqrt{2}}(|0\rangle + |1\rangle)|0\rangle = \frac{1}{\sqrt{2}}(|00\rangle + |10\rangle)$$

$$\text{CNOT}|+\rangle|0\rangle = \frac{1}{\sqrt{2}}(|00\rangle + |11\rangle) = |\Phi^+\rangle \quad \checkmark$$

**Part c) $(H \otimes H)\text{CNOT}_{12}(H \otimes H) = \text{CNOT}_{21}$**

Using $HXH = Z$ and $HZH = X$:

$$\text{CNOT}_{12} = |0\rangle\langle 0| \otimes I + |1\rangle\langle 1| \otimes X$$

$$(H \otimes H)\text{CNOT}_{12}(H \otimes H) = |+\rangle\langle +| \otimes I + |-\rangle\langle -| \otimes Z$$

Converting: $|+\rangle\langle +| = (I+X)/2$, $|-\rangle\langle -| = (I-X)/2$

$$= \frac{I \otimes I + X \otimes I + I \otimes Z - X \otimes Z}{2} = I \otimes |0\rangle\langle 0| + X \otimes |1\rangle\langle 1| = \text{CNOT}_{21} \quad \checkmark$$

**Part d) CNOT as exponential**

$$\text{CNOT} = e^{-i\frac{\pi}{4}(I - Z)(I - X)} = e^{i\frac{\pi}{4}}e^{-i\frac{\pi}{4}(I \otimes I - Z \otimes I - I \otimes X + Z \otimes X)}$$

Simplified: $\boxed{\text{CNOT} = e^{-i\frac{\pi}{4}(I-Z)\otimes(I-X)}}$

---

### Solution 12: Controlled Gates

**Part a) $\text{CZ} = (I \otimes H)\text{CNOT}(I \otimes H)$**

$$(I \otimes H)\text{CNOT}(I \otimes H) = (I \otimes H)(|0\rangle\langle 0| \otimes I + |1\rangle\langle 1| \otimes X)(I \otimes H)$$
$$= |0\rangle\langle 0| \otimes HH + |1\rangle\langle 1| \otimes HXH$$
$$= |0\rangle\langle 0| \otimes I + |1\rangle\langle 1| \otimes Z = \text{CZ} \quad \checkmark$$

**Part b) Controlled-$S$**

$$\text{CS} = |0\rangle\langle 0| \otimes I + |1\rangle\langle 1| \otimes S$$

Decomposition:
$$\boxed{\text{CS} = (I \otimes T)\text{CNOT}(I \otimes T^\dagger)\text{CNOT}(I \otimes T)}$$

This uses the identity $S = T^2$ and controlled phase extraction.

**Part c) Controlled-$R_z(\theta)$**

One CNOT is sufficient:
$$\text{C-}R_z(\theta) = (I \otimes R_z(\theta/2))\text{CNOT}(I \otimes R_z(-\theta/2))\text{CNOT}$$

---

### Solution 13: SWAP Decomposition

**Part a) $\text{SWAP} = \text{CNOT}_{12}\text{CNOT}_{21}\text{CNOT}_{12}$**

Direct verification on computational basis:
- $|00\rangle \to |00\rangle \to |00\rangle \to |00\rangle$ $\checkmark$
- $|01\rangle \to |01\rangle \to |11\rangle \to |10\rangle$ $\checkmark$
- $|10\rangle \to |11\rangle \to |01\rangle \to |01\rangle$ $\checkmark$
- $|11\rangle \to |10\rangle \to |10\rangle \to |11\rangle$ $\checkmark$

**Part b) $\sqrt{\text{SWAP}}$ decomposition**

$$\sqrt{\text{SWAP}} = \begin{pmatrix} 1 & 0 & 0 & 0 \\ 0 & \frac{1+i}{2} & \frac{1-i}{2} & 0 \\ 0 & \frac{1-i}{2} & \frac{1+i}{2} & 0 \\ 0 & 0 & 0 & 1 \end{pmatrix}$$

Decomposition requires 3 CNOTs with appropriate single-qubit gates.

---

### Solution 15: KAK Decomposition

**Part a) CNOT: $(c_1, c_2, c_3) = (\pi/4, 0, 0)$**

CNOT can be written as:
$$\text{CNOT} = e^{-i\frac{\pi}{4}XX} \cdot (\text{local gates})$$

The Cartan coordinates are $\boxed{(\pi/4, 0, 0)}$

**Part b) SWAP: $(c_1, c_2, c_3) = (\pi/4, \pi/4, \pi/4)$**

$$\text{SWAP} = e^{-i\frac{\pi}{4}(XX + YY + ZZ)} \cdot (\text{local gates})$$

$$\boxed{(\pi/4, \pi/4, \pi/4)}$$

**Part c) iSWAP: $(c_1, c_2, c_3) = (\pi/4, \pi/4, 0)$**

$$\boxed{(\pi/4, \pi/4, 0)}$$

**Part d) Constraints**

The Weyl chamber constraints: $\pi/4 \geq c_1 \geq c_2 \geq |c_3| \geq 0$

---

### Solution 17: Three-Qubit Gates

**Part a) Toffoli decomposition**

Minimum CNOT count: **6 CNOTs**

Decomposition:
$$\text{Toffoli} = (I \otimes I \otimes H) \cdot \text{(6 CNOTs + T gates)} \cdot (I \otimes I \otimes H)$$

The exact circuit uses relative phase Toffoli and T gates.

**Part b) $\{\text{Toffoli}, H\}$ is universal**

- Toffoli is universal for classical (reversible) computation
- $H$ creates superposition
- Toffoli + H can approximate any unitary (via magic state preparation)

---

## Section C: Universality Solutions

### Solution 19: Proving Universality

**Part a) $\{H, T, \text{CNOT}\}$ is universal**

**Step 1: $\{H, T\}$ generates dense subgroup of $SU(2)$**

$HTH = e^{i\pi/8}R_x(\pi/4)$ and $T = e^{i\pi/8}R_z(\pi/4)$

The group generated by $R_x(\pi/4)$ and $R_z(\pi/4)$ is dense in $SU(2)$ because $\pi/4$ is not a rational multiple of $2\pi$ when combined with different axes.

**Step 2: CNOT provides entanglement**

CNOT plus single-qubit gates can implement any two-qubit unitary (via KAK decomposition with 3 CNOTs).

**Step 3: Extension to $n$ qubits**

By induction, any $n$-qubit unitary can be decomposed into two-qubit and single-qubit operations.

**Part b) $\{H, S, \text{CNOT}\}$ is NOT universal**

This generates only the Clifford group, which is finite and can be classically simulated (Gottesman-Knill theorem).

**Part c) Conditions on $\theta$ for $\{R_x(\theta), R_y(\theta), \text{CNOT}\}$**

Universal if and only if $\theta/\pi$ is irrational.

If $\theta = p\pi/q$ for integers $p, q$, then only finitely many distinct rotations are generated.

---

### Solution 21: Solovay-Kitaev Bounds

**Part a) Best known $c \approx 3.97$**

The original Solovay-Kitaev gives $c \approx 4$. Optimized versions achieve $c \approx 3.97$.

**Part b) For $\epsilon = 10^{-10}$**

$$\text{Gates} \approx O(\log^{3.97}(10^{10})) = O((10 \ln 10)^{3.97}) \approx O(23^{3.97}) \approx 250,000$$

**Part c) Ross-Selinger comparison**

$$T\text{-count} \approx 3\log_2(10^{10}) = 3 \times 33.2 \approx 100$$

Ross-Selinger is dramatically more efficient for Clifford+T synthesis.

---

### Solution 22: Lower Bounds

**Part a) Need irrational gate**

If all gates have eigenvalues $e^{i\pi p/q}$ for rational $p/q$, then all products have eigenvalues in a finite set. This cannot be dense in $SU(2)$.

**Part b) $\Omega(\log(1/\epsilon))$ lower bound**

A finite gate set $\mathcal{G}$ with $|\mathcal{G}| = k$ has at most $k^n$ products of length $n$. These can cover at most $k^n$ balls of radius $\epsilon$ in $SU(2)$.

Volume argument: $\text{Vol}(SU(2)) / \epsilon^3 \lesssim k^n$

$$n \gtrsim 3\log(1/\epsilon)/\log k = \Omega(\log(1/\epsilon))$$

**Part c) No exact synthesis**

$SU(2)$ is uncountable; finite gate set generates countable subgroup.

---

## Section D: Advanced Solutions

### Solution 26: Complete Two-Qubit Decomposition

The given matrix is the 2-qubit QFT:
$$U = \text{QFT}_2 = \frac{1}{2}\begin{pmatrix} 1 & 1 & 1 & 1 \\ 1 & i & -1 & -i \\ 1 & -1 & 1 & -1 \\ 1 & -i & -1 & i \end{pmatrix}$$

**Part a) KAK parameters**

$(c_1, c_2, c_3) = (\pi/4, 0, 0)$ (same class as CNOT)

**Part b) Minimum CNOTs: 2**

The QFT can be implemented with 2 CNOTs.

**Part c) Explicit decomposition**

$$\text{QFT}_2 = (H \otimes I) \cdot \text{CNOT}_{21} \cdot (I \otimes R_z(\pi/2)) \cdot \text{CNOT}_{12} \cdot (H \otimes H)$$

---

### Solution 28: Universality of $\{R_x(\pi/4), R_z(\pi/5), \text{CZ}\}$

**Part a) Single-qubit universality**

$R_x(\pi/4)$ and $R_z(\pi/5)$ generate rotations about two different axes. Since $\pi/4$ and $\pi/5$ are not rationally related to $2\pi$, the generated group is dense in $SU(2)$.

Formally: The closure of $\langle R_x(\pi/4), R_z(\pi/5) \rangle$ contains all rotations.

**Part b) Entangling gate**

CZ is maximally entangling (same local equivalence class as CNOT).

**Part c) $n$-qubit completion**

- Single-qubit universality + CNOT-equivalent gate = full universality
- Any $n$-qubit unitary decomposes into single and two-qubit gates
- By Solovay-Kitaev, efficient approximation is guaranteed

$$\boxed{\{R_x(\pi/4), R_z(\pi/5), \text{CZ}\} \text{ is universal}}$$

---

### Solution 30: Comprehensive Synthesis

**Part a) Circuit design**

1. $|+\rangle^{\otimes 3}$: Apply $H^{\otimes 3}$ to $|000\rangle$
2. $e^{-i\pi ZZZ/8}$: Use CNOT ladder + $R_z(\pi/4)$
3. QFT on 3 qubits: Standard QFT circuit
4. Measure

**Part b) Clifford+T decomposition**

- $H$ gates: 3 (for $|+\rangle^{\otimes 3}$) + QFT H gates
- $ZZZ$ rotation: 2 CNOTs + $T$ gate ($\pi/8 = T$'s angle)
- QFT: H gates + controlled phase gates (each CPhase needs T gates)

**Part c) Gate count**

- H gates: approximately 6-8
- T gates: approximately 10-15 (depending on precision of phase gates)
- CNOT gates: approximately 8-10

**Part d) Optimization**

- Merge adjacent single-qubit gates
- Use T-depth optimization
- Circuit depth approximately 15-20 layers

**Part e) Error analysis**

T gate errors directly affect the $ZZZ$ rotation phase and QFT phases. If each T gate has error $\delta$, the final state has phase error $O(n_T \cdot \delta)$ where $n_T$ is the T-count.

---

*This completes the solutions for Week 161. For additional practice, see the Oral Practice questions.*
