# Week 161: Quantum Gates - Problem Set

## 30 Problems on Quantum Gates, Universality, and Synthesis

---

## Section A: Single-Qubit Gates (Problems 1-10)

### Problem 1: Pauli Matrix Algebra
Verify the following identities:
a) $XYZ = iI$
b) $\{X, Y\} = 0$ (anticommutator)
c) $[X, Y] = 2iZ$ (commutator)

Show that any $2 \times 2$ matrix $M$ can be written as $M = aI + bX + cY + dZ$ for complex coefficients $a, b, c, d$.

---

### Problem 2: Bloch Sphere Rotations
a) Show that the Hadamard gate corresponds to a rotation by $\pi$ about the axis $\hat{n} = (\hat{x} + \hat{z})/\sqrt{2}$.

b) Find the axis and angle of rotation for the gate:
$$G = \frac{1}{2}\begin{pmatrix} 1+i & 1-i \\ 1-i & 1+i \end{pmatrix}$$

c) What rotation does $R_x(\pi/2)R_z(\pi/2)R_x(-\pi/2)$ correspond to?

---

### Problem 3: ZYZ Decomposition
Find the ZYZ decomposition $U = e^{i\alpha}R_z(\beta)R_y(\gamma)R_z(\delta)$ for:

a) $H = \frac{1}{\sqrt{2}}\begin{pmatrix} 1 & 1 \\ 1 & -1 \end{pmatrix}$

b) $T = \begin{pmatrix} 1 & 0 \\ 0 & e^{i\pi/4} \end{pmatrix}$

c) $U = \frac{1}{\sqrt{2}}\begin{pmatrix} 1 & i \\ i & 1 \end{pmatrix}$

---

### Problem 4: Gate Composition
a) Express $R_x(\theta)$ in terms of $H$ and $R_z$ gates.

b) Show that $HTH = R_x(\pi/4)$ up to a global phase.

c) Find a single-qubit gate $U$ such that $UXU^\dagger = Y$.

---

### Problem 5: Eigenstructure
For each gate, find the eigenvalues and eigenvectors:
a) Hadamard gate $H$
b) $Y$ gate
c) $S = \begin{pmatrix} 1 & 0 \\ 0 & i \end{pmatrix}$

---

### Problem 6: Gate Identities
Prove or disprove:
a) $R_z(\theta)R_x(\phi)R_z(-\theta) = R_y(\phi)$ for all $\theta$
b) $e^{i\theta X}e^{i\phi Z}e^{-i\theta X} = e^{i\phi(\cos(2\theta)Z + \sin(2\theta)Y)}$
c) $HT^2H = S^\dagger X S$

---

### Problem 7: Rotation Composition
a) Using the fact that $SU(2)$ rotations compose like rotations in $SO(3)$, find the single rotation equivalent to $R_z(\pi/2)R_x(\pi/2)$.

b) Find $\theta$ such that $R_x(\pi/4)R_y(\pi/4)R_x(\pi/4) = R_{\hat{n}}(\theta)$ for some $\hat{n}$.

---

### Problem 8: Clifford Group
a) Show that the single-qubit Clifford group is generated by $\{H, S\}$.

b) Prove that the Clifford group has exactly 24 elements (up to global phase).

c) Show that $T$ is NOT in the Clifford group by finding a Pauli matrix $P$ such that $TPT^\dagger$ is not proportional to a Pauli matrix.

---

### Problem 9: Approximating Irrational Rotations
The gate set $\{H, T\}$ can approximate any single-qubit unitary.

a) Express $R_z(\pi/8)$ exactly in terms of $H$ and $T$.

b) Find the shortest sequence of $H$ and $T$ gates that approximates $R_z(\pi/5)$ to within 0.1 in operator norm.

c) Explain why $R_z(\theta)$ for irrational $\theta/\pi$ cannot be expressed exactly with any finite sequence of $H$ and $T$ gates.

---

### Problem 10: Magic Gates
A gate $U$ is called "magic" if it maps at least one Pauli eigenstate to a non-Pauli eigenstate.

a) Show that $T$ is a magic gate.

b) Prove that $H$ is NOT a magic gate (it maps Pauli eigenstates to Pauli eigenstates).

c) Find all single-qubit gates that are both Clifford and magic (if any exist).

---

## Section B: Two-Qubit Gates (Problems 11-18)

### Problem 11: CNOT Properties
a) Verify that $\text{CNOT}^2 = I$.

b) Show that $\text{CNOT}|+\rangle|0\rangle = \frac{1}{\sqrt{2}}(|00\rangle + |11\rangle) = |\Phi^+\rangle$.

c) Prove that $(H \otimes H)\text{CNOT}_{12}(H \otimes H) = \text{CNOT}_{21}$ (control and target swapped).

d) Express CNOT in terms of the exponential of Pauli operators.

---

### Problem 12: Controlled Gates
a) Show that $\text{Controlled-}Z = (I \otimes H)\text{CNOT}(I \otimes H)$.

b) Construct Controlled-$S$ using CNOT and single-qubit gates.

c) How many CNOT gates are needed to implement Controlled-$R_z(\theta)$?

---

### Problem 13: SWAP Decomposition
a) Prove that $\text{SWAP} = \text{CNOT}_{12}\text{CNOT}_{21}\text{CNOT}_{12}$.

b) Find a decomposition of $\sqrt{\text{SWAP}}$ into CNOTs and single-qubit gates.

c) Show that $\text{iSWAP} = (R_z(-\pi/2) \otimes R_z(-\pi/2))\sqrt{\text{SWAP}}(\text{some single-qubit gates})$.

---

### Problem 14: Entangling Power
The entangling power of a two-qubit gate $U$ is defined as:
$$e_p(U) = \frac{d}{d-1}\left(1 - \overline{|\text{Tr}(\rho_A^2)|}\right)$$
where $\rho_A$ is the reduced density matrix and the average is over Haar-random product inputs.

a) Show that CNOT is maximally entangling.

b) Compute the entangling power of $\sqrt{\text{SWAP}}$.

c) Prove that the identity gate has zero entangling power.

---

### Problem 15: KAK Decomposition
For the KAK decomposition $U = (A_1 \otimes A_2) \cdot K \cdot (B_1 \otimes B_2)$ where $K = e^{i(c_1 XX + c_2 YY + c_3 ZZ)}$:

a) Find $(c_1, c_2, c_3)$ for CNOT.

b) Find $(c_1, c_2, c_3)$ for SWAP.

c) Find $(c_1, c_2, c_3)$ for iSWAP.

d) What are the constraints on $(c_1, c_2, c_3)$ for any two-qubit gate?

---

### Problem 16: Local Equivalence
Two gates $U$ and $V$ are locally equivalent if $U = (A_1 \otimes A_2)V(B_1 \otimes B_2)$ for some single-qubit gates.

a) Show that CNOT and CZ are locally equivalent.

b) Are CNOT and SWAP locally equivalent? Prove your answer.

c) Find the local equivalence class of $\sqrt{\text{CNOT}}$.

---

### Problem 17: Three-Qubit Gates
a) Express the Toffoli gate (CCNOT) in terms of CNOT and single-qubit gates. What is the minimum CNOT count?

b) Show that $\{\text{Toffoli}, H\}$ is universal for quantum computation.

c) Express Controlled-SWAP (Fredkin gate) using Toffoli and simpler gates.

---

### Problem 18: Native Gate Sets
Different quantum hardware platforms have different native gate sets:

a) IBM uses $\{R_z(\theta), \sqrt{X}, \text{CNOT}\}$. Express $H$ in this gate set.

b) Google Sycamore uses the $\sqrt{\text{iSWAP}}$ as a native two-qubit gate. How many $\sqrt{\text{iSWAP}}$ gates are needed to implement CNOT?

c) Ion trap systems use the Molmer-Sorensen gate $XX(\theta) = e^{-i\theta XX/2}$. Express CNOT using $XX(\pi/2)$ and single-qubit gates.

---

## Section C: Universality and Solovay-Kitaev (Problems 19-25)

### Problem 19: Proving Universality
a) Prove that $\{H, T, \text{CNOT}\}$ is universal by showing:
   - $\{H, T\}$ generates a dense subgroup of $SU(2)$
   - Any two-qubit gate can be constructed

b) Is $\{H, S, \text{CNOT}\}$ universal? Prove your answer.

c) Is $\{R_x(\theta), R_y(\theta), \text{CNOT}\}$ universal for all values of $\theta$? Find the conditions on $\theta$.

---

### Problem 20: Density Arguments
a) Show that the set of rotations $\{R_z(\theta) : \theta = m\alpha + n\beta, m,n \in \mathbb{Z}\}$ is dense in the group of $z$-rotations if and only if $\alpha/\beta$ is irrational.

b) Use this to prove that $\{H, T\}$ generates a dense subgroup of $SU(2)$.

c) What if we replace $T$ with $R_z(\pi/6)$? Is $\{H, R_z(\pi/6)\}$ still universal?

---

### Problem 21: Solovay-Kitaev Bounds
a) The Solovay-Kitaev theorem states that any $U \in SU(2)$ can be $\epsilon$-approximated by $O(\log^c(1/\epsilon))$ gates. What is the current best known value of $c$?

b) For $\epsilon = 10^{-10}$, estimate the number of gates needed using Solovay-Kitaev.

c) The Ross-Selinger algorithm achieves $T$-count $\approx 3\log_2(1/\epsilon)$ for Clifford+T synthesis. Compare this to Solovay-Kitaev for $\epsilon = 10^{-10}$.

---

### Problem 22: Lower Bounds
a) Prove that any gate set generating a dense subgroup of $SU(2)$ must have at least one irrational gate (a gate with at least one eigenvalue whose argument is an irrational multiple of $\pi$).

b) Show that to $\epsilon$-approximate an arbitrary unitary in $SU(2)$, at least $\Omega(\log(1/\epsilon))$ gates from any finite set are needed.

c) Prove that no finite gate set can exactly implement all unitaries in $SU(2)$.

---

### Problem 23: Clifford + Magic States
In fault-tolerant quantum computing, non-Clifford gates are often implemented using magic states.

a) The $T$ magic state is $|T\rangle = T|+\rangle = \frac{1}{\sqrt{2}}(|0\rangle + e^{i\pi/4}|1\rangle)$. Show how to implement $T$ using $|T\rangle$ and Clifford operations.

b) How many copies of $|T\rangle$ are needed (on average) to distill one high-fidelity $|T\rangle$ state using the 15-to-1 magic state distillation protocol?

c) Explain why this makes $T$ gates expensive in fault-tolerant computation.

---

### Problem 24: Gate Set Tomography
a) Given access to an unknown single-qubit gate $U$, how would you determine whether it's in the Clifford group?

b) How many measurement settings are needed to fully characterize an unknown single-qubit gate (gate set tomography)?

c) Describe an experimental protocol to verify that a physical gate approximates the ideal $T$ gate to within error $\epsilon$.

---

### Problem 25: Compilation Complexity
a) Given a circuit with $m$ arbitrary single-qubit gates and $k$ CNOT gates, how many Clifford+T gates are needed to approximate it to error $\epsilon$?

b) For the quantum Fourier transform on $n$ qubits, estimate the $T$-count after compilation to Clifford+T.

c) Why is $T$-depth often more important than $T$-count in practical fault-tolerant compilation?

---

## Section D: Advanced and Synthesis Problems (Problems 26-30)

### Problem 26: Complete Two-Qubit Decomposition
Given the two-qubit unitary:
$$U = \frac{1}{2}\begin{pmatrix} 1 & 1 & 1 & 1 \\ 1 & i & -1 & -i \\ 1 & -1 & 1 & -1 \\ 1 & -i & -1 & i \end{pmatrix}$$

a) Find the KAK decomposition parameters $(c_1, c_2, c_3)$.
b) Determine the minimum number of CNOT gates needed.
c) Write an explicit decomposition using CNOT and single-qubit gates.

---

### Problem 27: Circuit Optimization
Consider the circuit: $H_1 \cdot \text{CNOT}_{12} \cdot T_1 \cdot \text{CNOT}_{12} \cdot H_1$

a) Compute the matrix representation of this circuit.
b) Find an equivalent circuit with fewer gates.
c) Is this circuit in the Clifford group? Justify your answer.

---

### Problem 28: Qualifying Exam Style - Universality Proof
**Complete Problem:** Prove that the gate set $\{R_x(\pi/4), R_z(\pi/5), \text{CZ}\}$ is universal for quantum computation.

Your proof should:
a) Show that single-qubit universality is achieved
b) Show that an entangling gate is available
c) Argue completeness for arbitrary $n$-qubit operations

---

### Problem 29: Research-Level - Gate Synthesis Challenge
The unitary $U = e^{-i\pi Z/7}$ needs to be synthesized using the Clifford+T gate set.

a) Explain why $U$ cannot be expressed exactly in Clifford+T.

b) Using the identity $T = e^{i\pi/8}R_z(\pi/4)$, estimate how many $T$ gates are needed to approximate $U$ to error $\epsilon = 10^{-6}$.

c) Describe an algorithm to find the optimal Clifford+T approximation.

d) If ancilla qubits are available, can you reduce the $T$-count? Explain.

---

### Problem 30: Comprehensive Synthesis
**Oral Exam Style Problem:**

A quantum algorithm requires implementing the following operations:
1. Prepare $|+\rangle^{\otimes 3}$
2. Apply $e^{-i\theta ZZZ}$ for $\theta = \pi/8$
3. Apply the quantum Fourier transform on 3 qubits
4. Measure in the computational basis

a) Design a complete circuit implementing this algorithm.

b) Decompose all operations into the gate set $\{H, T, \text{CNOT}\}$.

c) Count the total number of each gate type (H, T, CNOT).

d) Identify opportunities for optimization and estimate the circuit depth.

e) Discuss how errors in the $T$ gates would affect the final measurement outcomes.

---

## Problem Difficulty Summary

| Difficulty | Problems | Focus |
|------------|----------|-------|
| Foundational | 1, 2, 5, 11 | Basic definitions and calculations |
| Intermediate | 3, 4, 6, 7, 8, 12, 13, 19, 20 | Derivations and proofs |
| Advanced | 9, 10, 14-18, 21-25 | Deep understanding and applications |
| Research-Level | 26-30 | Synthesis and qualifying exam preparation |

---

*Complete solutions are available in Problem_Solutions.md*
