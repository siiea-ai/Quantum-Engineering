# Day 717: The Bacon-Shor Code

## Overview

**Date:** Day 717 of 1008
**Week:** 103 (Subsystem Codes)
**Month:** 26 (QEC Fundamentals II)
**Topic:** The Canonical Example of Subsystem Codes

---

## Schedule

| Block | Time | Duration | Focus |
|-------|------|----------|-------|
| Morning | 9:00 AM - 12:30 PM | 3.5 hrs | Bacon-Shor construction and structure |
| Afternoon | 2:00 PM - 4:30 PM | 2.5 hrs | Error correction and advantages |
| Evening | 7:00 PM - 8:00 PM | 1 hr | Implementation |

---

## Learning Objectives

By the end of this day, you should be able to:

1. **Construct the Bacon-Shor code** on an $m \times n$ lattice
2. **Identify gauge and stabilizer** generators
3. **Compute the code parameters** $[[mn, 1, m(n-1), \min(m,n)]]$
4. **Explain the weight reduction** via gauge operators
5. **Describe error correction** using gauge measurements
6. **Compare to the Shor code** (the $m=n=3$ case)

---

## Core Content

### 1. The Bacon-Shor Code Construction

#### The Lattice Structure

Arrange $n \cdot m$ qubits in an $m \times n$ rectangular lattice:

```
    Column 1    Column 2    ...    Column n
Row 1:  q(1,1)     q(1,2)     ...    q(1,n)
Row 2:  q(2,1)     q(2,2)     ...    q(2,n)
  ⋮       ⋮          ⋮               ⋮
Row m:  q(m,1)     q(m,2)     ...    q(m,n)
```

Qubit at position $(i,j)$ for row $i$, column $j$.

#### Gauge Generators

**X-type gauge:** Two-qubit XX on horizontally adjacent pairs
$$G^X_{i,(j,j+1)} = X_{i,j} X_{i,j+1}$$

**Z-type gauge:** Two-qubit ZZ on vertically adjacent pairs
$$G^Z_{(i,i+1),j} = Z_{i,j} Z_{i+1,j}$$

**Total gauge generators:**
- $m \times (n-1)$ X-type gauge operators
- $(m-1) \times n$ Z-type gauge operators

---

### 2. The Stabilizer Group

#### Derived from Gauge

The stabilizer is generated by products of gauge operators.

**X-type stabilizers:** Product of all X-gauges in a column pair
$$S^X_{(j,j+1)} = \prod_{i=1}^{m} X_{i,j} X_{i,j+1}$$

This gives $(n-1)$ independent X-stabilizers.

**Z-type stabilizers:** Product of all Z-gauges in a row pair
$$S^Z_{(i,i+1)} = \prod_{j=1}^{n} Z_{i,j} Z_{i+1,j}$$

This gives $(m-1)$ independent Z-stabilizers.

**Total stabilizer generators:** $(n-1) + (m-1) = n + m - 2$

---

### 3. Code Parameters

#### The $[[n \cdot m, 1, r, d]]$ Parameters

**Physical qubits:** $n \cdot m$

**Logical qubits:**
$$k = (n \cdot m) - (n + m - 2) - r$$

We have $r = m(n-1) + (m-1)n - (n+m-2) = 2mn - m - n - (n+m-2) + 2 = m(n-1) + (m-1)(n-1)$

Actually, let's count directly:
- Gauge generators: $m(n-1) + (m-1)n = 2mn - m - n$
- Minus stabilizer generators: $-(n + m - 2)$
- Number of gauge qubits: $r = (2mn - m - n) - (n + m - 2) = 2mn - 2m - 2n + 2 = 2(m-1)(n-1)$

No wait, that's counting pairs. Each pair gives one gauge qubit.

Actually: $r = (m-1)(n-1)$ gauge qubits.

**Logical qubits:** $k = 1$

**Distance:** $d = \min(m, n)$

**Summary:** The Bacon-Shor code is $[[mn, 1, (m-1)(n-1), \min(m,n)]]$

---

### 4. Logical Operators

#### Bare Logical Operators

**Bare $\bar{X}$:** X on all qubits in any row
$$\bar{X} = \prod_{j=1}^{n} X_{i,j} \quad \text{for any row } i$$

Weight: $n$

**Bare $\bar{Z}$:** Z on all qubits in any column
$$\bar{Z} = \prod_{i=1}^{m} Z_{i,j} \quad \text{for any column } j$$

Weight: $m$

#### Dressed Logical Operators

**Key insight:** We can dress with gauge operators!

**Dressed $\tilde{X}$:**
$$\tilde{X} = X_{i,j} \cdot \prod_{k \neq i} G^Z_{(k,k+1),j}$$

This has weight $1 + (m-1) = m$ (can be made local!)

Actually, simpler: $\tilde{X} = X_{i,j}$ works if we're in right gauge.

---

### 5. The $3 \times 3$ Case: Connection to Shor Code

#### Layout

```
    q(1,1)  q(1,2)  q(1,3)
    q(2,1)  q(2,2)  q(2,3)
    q(3,1)  q(3,2)  q(3,3)
```

9 qubits arranged in $3 \times 3$ grid.

#### Gauge Operators

**X-gauges (horizontal):** 6 operators
- $X_{1,1}X_{1,2}$, $X_{1,2}X_{1,3}$
- $X_{2,1}X_{2,2}$, $X_{2,2}X_{2,3}$
- $X_{3,1}X_{3,2}$, $X_{3,2}X_{3,3}$

**Z-gauges (vertical):** 6 operators
- $Z_{1,1}Z_{2,1}$, $Z_{2,1}Z_{3,1}$
- $Z_{1,2}Z_{2,2}$, $Z_{2,2}Z_{3,2}$
- $Z_{1,3}Z_{2,3}$, $Z_{2,3}Z_{3,3}$

#### Stabilizers

**X-stabilizers:** 2 operators
- $X_{1,1}X_{1,2}X_{2,1}X_{2,2}X_{3,1}X_{3,2}$ (columns 1-2)
- $X_{1,2}X_{1,3}X_{2,2}X_{2,3}X_{3,2}X_{3,3}$ (columns 2-3)

**Z-stabilizers:** 2 operators
- $Z_{1,1}Z_{2,1}Z_{1,2}Z_{2,2}Z_{1,3}Z_{2,3}$ (rows 1-2)
- $Z_{2,1}Z_{3,1}Z_{2,2}Z_{3,2}Z_{2,3}Z_{3,3}$ (rows 2-3)

#### Parameters

$[[9, 1, 4, 3]]$ subsystem code
- 9 physical qubits
- 1 logical qubit
- 4 gauge qubits
- Distance 3

#### Relation to Shor Code

The Shor [[9,1,3]] code is a **gauge-fixed** version:
- Fix all gauge qubits
- Get stabilizer code with 6 generators
- Same logical operators, same distance

---

### 6. Error Correction Procedure

#### Syndrome Measurement via Gauge

**Step 1:** Measure all X-gauge operators $G^X_{i,(j,j+1)}$

**Step 2:** Measure all Z-gauge operators $G^Z_{(i,i+1),j}$

**Step 3:** Compute stabilizer syndromes from products

**Step 4:** Decode and correct

#### Advantage: Weight-2 Measurements

All gauge operators have weight 2!
- Measure 2-qubit operators
- Infer 6-qubit stabilizer syndromes

Compare to stabilizer code:
- Would measure weight-6 operators directly
- Much harder to implement fault-tolerantly

---

### 7. Error Correction Analysis

#### X-Error Detection

An X error on qubit $(i,j)$ anticommutes with:
- $G^Z_{(i-1,i),j}$ if $i > 1$
- $G^Z_{(i,i+1),j}$ if $i < m$

**Syndrome pattern:** Two adjacent Z-gauge failures in column $j$

#### Z-Error Detection

A Z error on qubit $(i,j)$ anticommutes with:
- $G^X_{i,(j-1,j)}$ if $j > 1$
- $G^X_{i,(j,j+1)}$ if $j < n$

**Syndrome pattern:** Two adjacent X-gauge failures in row $i$

#### Correcting Errors

Syndrome uniquely identifies error location (for single errors).

Apply correction: X or Z at identified location.

---

## Worked Examples

### Example 1: The $2 \times 2$ Bacon-Shor Code

**Problem:** Construct the smallest Bacon-Shor code and find its parameters.

**Solution:**

**Qubits:** 4 in $2 \times 2$ grid

**Gauge operators:**
- X-type: $X_{1,1}X_{1,2}$, $X_{2,1}X_{2,2}$ (2 operators)
- Z-type: $Z_{1,1}Z_{2,1}$, $Z_{1,2}Z_{2,2}$ (2 operators)

**Stabilizers:**
- X: $X_{1,1}X_{1,2}X_{2,1}X_{2,2}$ (1 operator)
- Z: $Z_{1,1}Z_{2,1}Z_{1,2}Z_{2,2}$ (1 operator)

**Parameters:**
- $n = 4$ physical qubits
- Stabilizer: 2 generators → code space $2^{4-2} = 4$ dimensional
- Gauge qubits: $r = (2-1)(2-1) = 1$
- Logical qubits: $k = 1$
- Distance: $d = \min(2,2) = 2$

**Result:** $[[4, 1, 1, 2]]$ — this is our earlier example!

---

### Example 2: Compute Syndromes for an Error

**Problem:** In the $3 \times 3$ Bacon-Shor code, what syndromes result from $X_{2,2}$ error?

**Solution:**

$X_{2,2}$ anticommutes with Z-gauge operators involving qubit $(2,2)$:
- $G^Z_{(1,2),2} = Z_{1,2}Z_{2,2}$: anticommutes ✓
- $G^Z_{(2,3),2} = Z_{2,2}Z_{3,2}$: anticommutes ✓

All other gauge operators commute with $X_{2,2}$.

**Syndrome pattern:**
- Z-gauge $(1,2),2$: $-1$
- Z-gauge $(2,3),2$: $-1$
- All other gauges: $+1$

This uniquely identifies column 2, rows 1-2 and 2-3 → error at $(2,2)$.

---

### Example 3: Gauge Fixing to Shor Code

**Problem:** Show how to gauge-fix the $3 \times 3$ Bacon-Shor to get the Shor code.

**Solution:**

**Original stabilizer:** 4 generators (2 X-type, 2 Z-type)

**Add gauge operators to stabilizer:**
- Add $Z_{1,1}Z_{2,1}$ → fixes gauge qubit 1
- Add $Z_{1,2}Z_{2,2}$ → fixes gauge qubit 2
- Add $Z_{1,3}Z_{2,3}$ → fixes gauge qubit 3
- Add $Z_{2,1}Z_{3,1}$ → fixes gauge qubit 4

Wait, we only have 4 gauge qubits. So add 4 gauge operators.

**New stabilizer:** $4 + 4 = 8$ generators

But 8 generators for 9 qubits gives $2^{9-8} = 2$ dimensional code = 1 logical qubit ✓

**Result:** The Shor [[9,1,3]] code with:
- Stabilizers including the original 4 plus 4 Z-gauge operators
- Or equivalently, the standard Shor stabilizers

---

## Practice Problems

### Direct Application

1. **Problem 1:** For a $4 \times 3$ Bacon-Shor code, count the X-gauge and Z-gauge operators.

2. **Problem 2:** What is the distance of a $5 \times 3$ Bacon-Shor code?

3. **Problem 3:** In the $3 \times 3$ code, what is the syndrome for a $Z_{1,1}$ error?

### Intermediate

4. **Problem 4:** Prove that the bare logical $\bar{X}$ (X on row 1) commutes with all gauge operators.

5. **Problem 5:** Find the dressed logical operators for the $2 \times 2$ code with minimum weight.

6. **Problem 6:** Design the error correction lookup table for single X errors in the $3 \times 3$ code.

### Challenging

7. **Problem 7:** Prove that the Bacon-Shor code has distance $d = \min(m,n)$.

8. **Problem 8:** Show that any single-qubit error can be corrected using only gauge measurements.

9. **Problem 9:** Generalize the Bacon-Shor construction to 3D lattices and determine the parameters.

---

## Summary

### Key Concepts

| Concept | Description |
|---------|-------------|
| **Bacon-Shor code** | $[[mn, 1, (m-1)(n-1), \min(m,n)]]$ subsystem code |
| **X-gauge** | Horizontal XX on adjacent pairs |
| **Z-gauge** | Vertical ZZ on adjacent pairs |
| **Stabilizer** | Products of all gauges in row/column |
| **Weight reduction** | Gauge operators are weight-2 |

### Main Takeaways

1. **Bacon-Shor** is the canonical subsystem code example
2. **Gauge operators** are weight-2 (vs weight-$m$ or weight-$n$ stabilizers)
3. **3×3 case** is related to the Shor code by gauge fixing
4. **Error syndromes** from gauge measurements identify error location
5. **Distance** equals $\min(m,n)$, independent of lattice size

---

## Preview: Day 718

Tomorrow we study **Subsystem Code Properties**, including:
- Distance and error correction conditions
- Relationship between gauge and error correction
- Subsystem code bounds
- Comparison with stabilizer codes
